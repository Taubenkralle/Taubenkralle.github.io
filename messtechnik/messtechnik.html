<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Messtechnik</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
@import url("https://fonts.googleapis.com/css2?family=IM+Fell+English:ital,wght@0,400;0,700;1,400&family=IM+Fell+English+SC&display=swap");

:root{
  --shadow: rgba(19,10,5,0.45);
}

body{
  margin:0;
  min-height:100vh;
  display:block;
  font-size: 18px;
}

body.theme-onepiece{
  --sea:#0b1b2a;
  --deep:#06111b;
  --sand:#f3e2c4;
  --ink:#2b1a0c;
  --gold:#d2a654;
  --rope:#a9824f;
  --rust:#8a2b1d;
  --seafoam:#7fc7b4;
  --mapline:#d6b47c;
  --paper:#f7e6c6;
  --paper-dark:#dfc08c;
  --wood:#5b3b1c;
  --heading: #101820;
  --link: #2c4f6b;
  --link-hover: #3b6d91;
  --link-shadow: 0 0 10px rgba(59,109,145,0.25);
  color: #3b2412;
  --rain-opacity: 0.12;
  --rain-filter: hue-rotate(180deg) saturate(0.3);
  --toggle-bg: linear-gradient(180deg, #f7e6c6 0%, #dfc08c 100%);
  --toggle-border: #5c3b1d;
  --toggle-text: #4b2d17;
  --toggle-shadow: 0 8px 16px rgba(40,22,10,0.45);
  background:
    radial-gradient(900px 540px at 50% 35%, rgba(253,233,197,0.65) 0%, rgba(217,185,130,0.3) 40%, rgba(12,28,43,0.25) 70%),
    linear-gradient(180deg, #0a1724 0%, #0f2738 45%, #0a1b28 100%);
  color: var(--sand);
  font-family: "IM Fell English", "Garamond", "Georgia", serif;
}

body.theme-onepiece p,
body.theme-onepiece li,
body.theme-onepiece td,
body.theme-onepiece th,
body.theme-onepiece dl,
body.theme-onepiece dd{
  color: #3b2412;
}

body.theme-onepiece .toc-label,
body.theme-onepiece .toc-title,
body.theme-onepiece .search-meta,
body.theme-onepiece .search-empty,
body.theme-onepiece .bm-meta{
  color: #3b2412;
}

body.theme-matrix{
  --bg:#050a06;
  --g1:#00ff66;
  --g2:#00cc55;
  --g3:#00ff99;
  --heading: var(--g1);
  --link: var(--g3);
  --link-hover: var(--g3);
  --link-shadow: 0 0 12px rgba(0,255,102,0.35);
  --rain-opacity: 0.28;
  --rain-filter: none;
  --toggle-bg: rgba(0,0,0,0.4);
  --toggle-border: rgba(0,255,102,0.35);
  --toggle-text: var(--g1);
  --toggle-shadow: 0 0 14px rgba(0,255,102,0.18);
  background: radial-gradient(1200px 800px at 50% 40%, #07140b 0%, var(--bg) 60%, #000 100%);
  color: var(--g1);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}

body.theme-matrix h1,
body.theme-matrix h2,
body.theme-matrix h3{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing:0.08em;
  text-shadow: 0 0 10px rgba(0,255,102,.35), 0 0 24px rgba(0,255,102,.18);
}

body.theme-matrix .map-layer{
  display: none;
}

body::before{
  content:"";
  position:fixed;
  inset:0;
  background:
    repeating-linear-gradient(0deg, rgba(255,233,199,0.05) 0px, rgba(255,233,199,0.05) 2px, transparent 2px, transparent 10px),
    repeating-linear-gradient(90deg, rgba(0,0,0,0.12) 0px, rgba(0,0,0,0.12) 1px, transparent 1px, transparent 14px);
  opacity:0.5;
  pointer-events:none;
  mix-blend-mode:soft-light;
}

.map-layer{
  position: fixed;
  inset: 0;
  z-index: 0;
  overflow: hidden;
  background-image: image-set(
    url("/messtechnik/assets/map.webp") type("image/webp"),
    url("/messtechnik/assets/map.png") type("image/png")
  );
  background-size: contain;
  background-position: center top;
  background-repeat: no-repeat;
  background-color: #b1865a;
}

.map-route{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.map-ship{
  filter: drop-shadow(0 6px 6px rgba(12,6,3,0.45));
}

main{
  max-width: 760px;
  margin: 140px auto 90px auto;
  line-height: 1.75;
  padding: 0 18px;
}

.theme-onepiece h1::after,
.theme-onepiece h2::after{
  content: none !important;
}

h1, h2{
  animation: none;
}

h1 .flag{
  display: inline-flex;
  vertical-align: middle;
  margin-left: 10px;
  width: 78px;
  height: 46px;
}

body.theme-matrix h1 .flag{
  display: none;
}

.flag svg{
  width: 100%;
  height: 100%;
  overflow: visible;
}

.theme-onepiece main::before{
  content: none;
}

h1, h2, h3{
  font-family: "IM Fell English SC", "Garamond", "Georgia", serif;
  letter-spacing:0.06em;
  color: var(--heading, var(--sand));
  text-shadow: 0 6px 16px var(--shadow);
}

h1{
  font-size: 40px;
  margin-bottom: 12px;
}

a{
  color: var(--link, var(--gold));
  text-decoration:none;
}

a:hover{
  color: var(--link-hover, #f6d48a);
  text-shadow: var(--link-shadow, 0 0 12px rgba(255,215,140,0.3));
}

#rain{
  opacity: var(--rain-opacity, 0.12);
  filter: var(--rain-filter, none);
}

/* Home-Button */
.home-only{
  position:fixed;
  top:20px;
  left:20px;
}

.home{
  color: var(--heading, var(--sand));
  font-size:18px;
  opacity:.85;
  font-family: "IM Fell English SC", "Garamond", "Georgia", serif;
}
.home:hover{ opacity:1; }

/* TOC */
.toc{
  margin-top:18px;
  text-align:center;
  opacity:.95;
}

.toc-label{
  font-size:12px;
  letter-spacing:0.22em;
  text-transform:uppercase;
  color: var(--link, var(--gold));
  opacity:.9;
}

.toc ul{ list-style:none; padding:0; margin:10px 0 0 0; }
.toc li{ margin:8px 0; }

.toc a{
  color: var(--link, var(--gold));
  font-size:14px;
  opacity:.95;
}
.toc a:hover{
  opacity:1;
  text-shadow: 0 0 12px rgba(255,215,140,0.35);
}

/* One Piece inspired control chrome */
.theme-onepiece .search-actions{
  gap: 8px;
}

.theme-onepiece .home-mini,
.theme-onepiece .search-toggle,
.theme-onepiece .music-button,
.theme-onepiece .view-toggle{
  width: 30px;
  height: 30px;
  border-radius: 10px;
  border: 2px solid var(--rope);
  background: linear-gradient(180deg, #f6e5c8 0%, #dfbc83 100%);
  color: var(--ink);
  box-shadow: 0 6px 14px rgba(14,7,3,0.35), inset 0 0 12px rgba(255,244,224,0.6);
  transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
}

.theme-onepiece .home-mini:hover,
.theme-onepiece .search-toggle:hover,
.theme-onepiece .music-button:hover,
.theme-onepiece .view-toggle:hover{
  transform: translateY(-1px);
  border-color: var(--gold);
  box-shadow: 0 10px 20px rgba(14,7,3,0.4), inset 0 0 12px rgba(255,244,224,0.7);
}

.theme-onepiece .music-button.playing,
.theme-onepiece .view-toggle.active{
  border-color: var(--rust);
  box-shadow: 0 0 0 2px rgba(138,43,29,0.35), 0 10px 20px rgba(14,7,3,0.4), inset 0 0 14px rgba(255,228,184,0.7);
}

.theme-onepiece .search-panel{
  background: rgba(21,14,10,0.85);
  border: 1px solid rgba(210,166,84,0.45);
  box-shadow: 0 14px 30px rgba(8,4,2,0.55);
}

.theme-onepiece .search-panel::before{
  background: linear-gradient(180deg, rgba(210,166,84,0) 0%, rgba(210,166,84,0.3) 50%, rgba(210,166,84,0) 100%);
  opacity: 0.3;
}

.theme-onepiece .search-input{
  background: rgba(244,226,196,0.1);
  border: 1px solid rgba(210,166,84,0.45);
  color: var(--sand);
}

.theme-onepiece .search-input::placeholder{
  color: rgba(246,228,184,0.6);
}

.theme-onepiece .search-close{
  border: 1px solid rgba(210,166,84,0.45);
  color: var(--sand);
}

.theme-onepiece .search-results a{
  border: 1px solid rgba(210,166,84,0.35);
  background: rgba(24,14,10,0.65);
  color: #f2d39b;
}

.theme-onepiece .search-results a:hover{
  box-shadow: 0 0 14px rgba(210,166,84,0.35);
}

.theme-onepiece .search-title{
  color: #f6d48a;
  text-shadow: 0 0 10px rgba(210,166,84,0.25);
}

.theme-onepiece .search-meta{
  color: rgba(243,226,196,0.7);
}

/* Pirate TOC + bookmarks */
.theme-onepiece .toc-panel{
  background:
    linear-gradient(180deg, rgba(255,240,210,0.92) 0%, rgba(235,208,158,0.94) 55%, rgba(210,176,120,0.96) 100%),
    repeating-linear-gradient(90deg, rgba(90,60,30,0.12) 0px, rgba(90,60,30,0.12) 2px, transparent 2px, transparent 18px),
    repeating-linear-gradient(0deg, rgba(120,90,50,0.08) 0px, rgba(120,90,50,0.08) 1px, transparent 1px, transparent 6px);
  border-right: 4px solid #5c3b1d;
  color: var(--sand);
  box-shadow: 10px 0 24px rgba(0, 0, 0, 0.4), inset 0 0 18px rgba(210,166,84,0.18);
}

.theme-onepiece .toc-panel::before{
  content: "";
  position: absolute;
  inset: 8px;
  border: 2px dashed rgba(120,84,46,0.45);
  border-radius: 10px;
  pointer-events: none;
  opacity: 0.7;
}

.theme-onepiece .toc-panel::after{
  content: "";
  position: absolute;
  inset: 0;
  border-right: 10px solid rgba(92,59,29,0.65);
  box-shadow: inset 0 0 26px rgba(60,32,12,0.5);
  pointer-events: none;
}

.theme-onepiece .toc-title{
  color: #5a3b1f;
  text-shadow: 0 2px 6px rgba(60,32,12,0.35);
}

.theme-onepiece .toc-close{
  border: 2px solid rgba(92,59,29,0.6);
  color: #5a3b1f;
  background: rgba(255,240,210,0.8);
}

.theme-onepiece .toc-list a{
  border: 1px solid rgba(120,84,46,0.45);
  background: rgba(255,243,220,0.9);
  color: #553517;
}

.theme-onepiece .toc-list a:hover{
  box-shadow: 0 0 14px rgba(120,84,46,0.35);
}

.theme-onepiece .toc-list a.toc-active{
  border-color: rgba(120,84,46,0.9);
  box-shadow: 0 0 16px rgba(120,84,46,0.35), inset 0 0 10px rgba(210,166,84,0.3);
  color: #3d240f;
}

.theme-onepiece .toc-tab{
  background: linear-gradient(180deg, #f7e6c6 0%, #dfc08c 100%);
  border: 2px solid #5c3b1d;
  color: #4b2d17;
  box-shadow: 0 6px 12px rgba(40,22,10,0.4);
}

.theme-onepiece .toc-tab::before,
.theme-onepiece .toc-tab::after{
  content: "";
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #c6a06a;
  box-shadow: inset 0 0 2px rgba(60,32,12,0.6);
}

.theme-onepiece .toc-tab::before{
  left: 4px;
  top: 6px;
}

.theme-onepiece .toc-tab::after{
  right: 4px;
  top: 6px;
}

.theme-onepiece .toc-tab:hover{
  box-shadow: 0 8px 16px rgba(40,22,10,0.45);
}

.theme-onepiece .bm-panel{
  background:
    linear-gradient(180deg, rgba(255,240,210,0.92) 0%, rgba(235,208,158,0.94) 55%, rgba(210,176,120,0.96) 100%),
    repeating-linear-gradient(90deg, rgba(90,60,30,0.12) 0px, rgba(90,60,30,0.12) 2px, transparent 2px, transparent 18px),
    repeating-linear-gradient(0deg, rgba(120,90,50,0.08) 0px, rgba(120,90,50,0.08) 1px, transparent 1px, transparent 6px);
  border-left: 4px solid #5c3b1d;
  color: var(--sand);
  box-shadow: -10px 0 24px rgba(0, 0, 0, 0.4), inset 0 0 18px rgba(210,166,84,0.18);
}

.theme-onepiece .bm-panel::before{
  content: "";
  position: absolute;
  inset: 8px;
  border: 2px dashed rgba(120,84,46,0.45);
  border-radius: 10px;
  pointer-events: none;
  opacity: 0.7;
}

.theme-onepiece .bm-panel::after{
  content: "";
  position: absolute;
  inset: 0;
  border-left: 10px solid rgba(92,59,29,0.65);
  box-shadow: inset 0 0 26px rgba(60,32,12,0.5);
  pointer-events: none;
}

.theme-onepiece .bm-title{
  color: #5a3b1f;
  text-shadow: 0 2px 6px rgba(60,32,12,0.35);
}

.theme-onepiece .bm-close{
  border: 2px solid rgba(92,59,29,0.6);
  color: #5a3b1f;
  background: rgba(255,240,210,0.8);
}

.theme-onepiece .bm-actions button{
  background: rgba(255,243,220,0.9);
  border: 1px solid rgba(120,84,46,0.5);
  color: #4b2d17;
}

.theme-onepiece .bm-jump{
  background: rgba(255,243,220,0.9);
  border: 1px solid rgba(120,84,46,0.4);
  color: #4b2d17;
}

.theme-onepiece .bm-jump:hover{
  box-shadow: 0 0 14px rgba(120,84,46,0.35);
  animation: none;
}

.theme-onepiece .bm-jump.bm-active{
  border-color: rgba(120,84,46,0.9);
  box-shadow: 0 0 16px rgba(120,84,46,0.35), inset 0 0 10px rgba(210,166,84,0.3);
}

.theme-onepiece .bm-matrix{
  display: none;
}

.theme-onepiece .bm-label{
  color: #553517;
  text-shadow: 0 0 6px rgba(120,84,46,0.25);
}

.theme-onepiece .bm-edit,
.theme-onepiece .bm-del{
  background: rgba(255,243,220,0.9);
  border: 1px solid rgba(120,84,46,0.5);
  color: #4b2d17;
}

.theme-onepiece .bm-tab{
  background: linear-gradient(180deg, #f7e6c6 0%, #dfc08c 100%);
  border: 2px solid #5c3b1d;
  color: #4b2d17;
  box-shadow: 0 6px 12px rgba(40,22,10,0.4);
}

.theme-onepiece .bm-tab::before,
.theme-onepiece .bm-tab::after{
  content: "";
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #c6a06a;
  box-shadow: inset 0 0 2px rgba(60,32,12,0.6);
}

.theme-onepiece .bm-tab::before{
  left: 4px;
  top: 6px;
}

.theme-onepiece .bm-tab::after{
  right: 4px;
  top: 6px;
}

.theme-onepiece .bm-tab:hover{
  box-shadow: 0 8px 16px rgba(40,22,10,0.45);
}
  </style>
  <link rel="stylesheet" href="../bookmarks.css">
  <link rel="stylesheet" href="../search.css">
  <link rel="stylesheet" href="../toc.css">
  <link rel="stylesheet" href="../music.css">
  <link rel="stylesheet" href="../themes.css">
  <link rel="stylesheet" href="../matrix-effects.css">
  <link rel="stylesheet" href="../crt.css">
  <link rel="stylesheet" href="../neo.css">
</head>
<body class="theme-matrix" data-default-theme="matrix">
  <div class="map-layer" aria-hidden="true">
    <svg class="map-route" viewBox="0 0 1080 540" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <defs>
        <filter id="softGlow" x="-20%" y="-20%" width="140%" height="140%">
          <feGaussianBlur stdDeviation="6" result="blur"/>
          <feColorMatrix in="blur" type="matrix"
            values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 0.6 0" result="glow"/>
          <feMerge>
            <feMergeNode in="glow"/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
      </defs>
      <path id="route-path" d="M1020 80 C 900 130, 760 190, 620 240 C 580 255, 560 265, 540 270 C 620 285, 720 285, 820 280 C 920 275, 1000 270, 1040 270"
        fill="none" stroke="#c4533c" stroke-width="4.5" stroke-dasharray="8 10" stroke-linecap="round" filter="url(#softGlow)"/>
      <image id="ship" class="map-ship" href="/messtechnik/assets/ship.png" xlink:href="/messtechnik/assets/ship.png" width="90" height="70" x="-45" y="-35" />
    </svg>
  </div>
  <canvas id="rain"></canvas>
  <nav class="home-only">
  <a href="../index.html" class="home">Schreibtisch</a>
</nav>

  <div class="search-shell" data-index="../search-index.json">
    <div class="search-actions">
      <a class="home-mini" href="../index.html" aria-label="Home">
        <svg class="home-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 4l8 7h-2v9h-5v-6H11v6H6v-9H4l8-7z"></path>
        </svg>
      </a>
      <button class="search-toggle" type="button" aria-label="Suche">
        <svg class="search-icon" viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" fill="none"></circle>
          <line x1="16.65" y1="16.65" x2="21" y2="21" stroke="currentColor" stroke-width="2"></line>
        </svg>
      </button>
      <div class="music-shell">
        <button class="music-button" type="button" aria-label="Musik">
          <svg class="music-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M19 3v12.5a3.5 3.5 0 1 1-2-3.16V6.6l-8 1.7v8.2a3.5 3.5 0 1 1-2-3.16V4.5L19 3z"></path>
          </svg>
        </button>
        <button class="view-toggle" type="button" aria-label="Breiter Text" aria-pressed="false">
          <svg class="view-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M7 6h10v2H7V6zm-2 4h14v2H5v-2zm2 4h10v2H7v-2z"></path>
          </svg>
        </button>
      </div>
    </div>
    <div class="search-panel" hidden>
      <div class="search-bar">
        <input class="search-input" type="search" placeholder="Suche in der Matrix">
        <button class="search-close" type="button">x</button>
      </div>
      <ul class="search-results"></ul>
      <div class="search-empty">Keine Treffer.</div>
    </div>
  </div>

  <main>
  <h1>Messtechnik
    <span class="flag" aria-hidden="true">
      <svg viewBox="0 0 120 70" role="img">
        <defs>
          <filter id="flagWave">
            <feTurbulence type="fractalNoise" baseFrequency="0.016 0.06" numOctaves="2" seed="3" result="noise">
              <animate attributeName="baseFrequency" dur="2.6s" values="0.016 0.06;0.03 0.08;0.016 0.06" repeatCount="indefinite"/>
            </feTurbulence>
            <feDisplacementMap in="SourceGraphic" scale="14" xChannelSelector="R" yChannelSelector="G"/>
          </filter>
        </defs>
        <rect x="2" y="6" width="6" height="56" rx="2" fill="#7a4c2a"/>
        <g filter="url(#flagWave)">
          <image href="/messtechnik/assets/flagge.png" xlink:href="/messtechnik/assets/flagge.png" x="10" y="8" width="100" height="54" />
        </g>
      </svg>
    </span>
  </h1>

  <h2>Namis Karte</h2>
  <p>
    Hier entsteht der Atlas der Crew: Strukturen, Daten und Praxis, die den
    Kurs sauber halten. Messtechnik als Navigation im All Blue.
  </p>

  <h2>Kompass</h2>
  <p>
    Gute Messungen haben Aufloesung, Genauigkeit und Wiederholbarkeit im Griff
    und bleiben transparent bei der Messunsicherheit.
  </p>

  <h3>Bausteine</h3>
  <ul>
    <li>Sensoren, Signale und Schnittstellen</li>
    <li>Kalibrierung und Referenzen</li>
    <li>Auswertung mit Augenmass</li>
  </ul>

  <p>
    Scrolle nach unten: die Flying Lamb segelt die Route weiter.
  </p>

  </main>
  <footer class="theme-toggle">
    <button class="theme-button" type="button" data-theme-toggle>Theme: One Piece</button>
  </footer>
  <iframe
    id="soundcloud-player"
    title="SoundCloud Player"
    width="1"
    height="1"
    allow="autoplay"
    style="position:absolute; left:-9999px; opacity:0; pointer-events:none;"
    src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/mrjuggler/woonan-and-ganzo&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&visual=false">
  </iframe>
  <script src="../rain.js"></script>
  <script src="../bookmarks.js"></script>
  <script src="../search.js"></script>
  <script src="../toc.js"></script>
  <script src="../view.js"></script>
  <script src="../crt.js"></script>
  <script src="../neo.js"></script>
  <script src="../themes.js"></script>
  <script src="https://w.soundcloud.com/player/api.js"></script>
  <script>
(() => {
  const shell = document.querySelector(".music-shell");
  const btn = shell ? shell.querySelector(".music-button") : null;
  const iframe = document.getElementById("soundcloud-player");
  if (!btn || !iframe) return;

  let widget = null;
  let isReady = false;
  let isPlaying = false;

  function setPlaying(value){
    isPlaying = value;
    btn.classList.toggle("playing", value);
  }

  function ensureWidget(){
    if (widget) return widget;
    if (!window.SC || !SC.Widget) return null;
    widget = SC.Widget(iframe);
    widget.bind(SC.Widget.Events.READY, () => {
      isReady = true;
    });
    widget.bind(SC.Widget.Events.PLAY, () => setPlaying(true));
    widget.bind(SC.Widget.Events.PAUSE, () => setPlaying(false));
    widget.bind(SC.Widget.Events.FINISH, () => setPlaying(false));
    return widget;
  }

  function play(){
    const sc = ensureWidget();
    if (!sc) return;
    if (!isReady){
      sc.bind(SC.Widget.Events.READY, () => sc.play());
      return;
    }
    sc.play();
  }

  function pause(){
    const sc = ensureWidget();
    if (!sc) return;
    sc.pause();
  }

  function toggle(){
    if (isPlaying){
      pause();
      return;
    }
    play();
  }

  btn.addEventListener("click", toggle);
  document.addEventListener("keydown", (e) => {
    const active = document.activeElement;
    const isTyping = active && (active.tagName === "INPUT" || active.tagName === "TEXTAREA" || active.isContentEditable);
    if (isTyping) return;
    if (e.key === "4"){
      e.preventDefault();
      toggle();
    }
  });
})();
  </script>
  <script>
(() => {
  const route = document.getElementById("route-path");
  const ship = document.getElementById("ship");
  if (!route || !ship) return;

  const total = route.getTotalLength();

  let lastScrollTop = 0;
  let direction = 1;

  function updateShip(){
    const doc = document.documentElement;
    const scrollTop = doc.scrollTop || document.body.scrollTop || 0;
    const maxScroll = doc.scrollHeight - doc.clientHeight;
    const t = maxScroll > 0 ? scrollTop / maxScroll : 0;
    if (scrollTop !== lastScrollTop){
      direction = scrollTop > lastScrollTop ? 1 : -1;
      lastScrollTop = scrollTop;
    }
    const current = total * t;
    const point = route.getPointAtLength(current);
    const sample = Math.min(total, Math.max(0, current + direction));
    const target = route.getPointAtLength(sample);
    let angle = Math.atan2(target.y - point.y, target.x - point.x) * 180 / Math.PI;
    if (angle > 90) angle -= 180;
    if (angle < -90) angle += 180;
    const flip = direction === -1 ? -1 : 1;
    ship.setAttribute("transform", `translate(${point.x} ${point.y}) rotate(${angle}) scale(${flip} 1)`);
  }

  updateShip();
  window.addEventListener("scroll", updateShip, { passive: true });
  window.addEventListener("resize", updateShip);
})();
  </script>
</body>
</html>
